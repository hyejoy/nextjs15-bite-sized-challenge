# section04-02 페이지 라우팅 설정하기

## ✅ App Router

- app 폴더의 구조를 기반으로 페이지를 라우팅
- page.tsx 이름을 갖는 파일만 페이지 파일로써 취급됨
- URL 경로는 폴더 이름 기준
- 실제 페이지 렌더링은 page.tsx가 담당
- 폴더만 만들고 page.tsx가 없으면 라우트가 생성되지 않음

## 기본파일 기반 라우팅

```bash
app/
├─ page.tsx
├─ about/
│  └─ page.tsx
└─ contact/
   └─ page.tsx


```

| 파일 경로              | URL        |
| ---------------------- | ---------- |
| `app/page.tsx`         | `/`        |
| `app/about/page.tsx`   | `/about`   |
| `app/contact/page.tsx` | `/contact` |

## 중첩 라우팅

```bash
app/
└─ blog/
   └─ page.tsx

```

| 파일 경로           | URL     |
| ------------------- | ------- |
| `app/blog/page.tsx` | `/blog` |

## 더 깊은 중첩 구조

```bash
app/
└─ blog/
   └─ post/
      └─ page.tsx

```

| 파일 경로                | URL          |
| ------------------------ | ------------ |
| `app/blog/post/page.tsx` | `/blog/post` |

## 동적 라우팅

```bash
app/
└─ book/
   └─ [id]/
      └─ page.tsx

```

| URL 요청    | 매칭 파일                |
| ----------- | ------------------------ |
| `/book/1`   | `app/book/[id]/page.tsx` |
| `/book/abc` | `app/book/[id]/page.tsx` |

## 동적 파라미터 사용 예시

```tsx
export default function PostPage({ params }: { params: { id: string } }) {
  return <div>Post ID: {params.id}</div>;
}
```

## 정리

- App Router는 폴더 중심 라우팅 구조
- page.tsx가 있어야 URL이 생성됨
- 레이아웃, 로딩, 에러를 파일 단위로 분리
- 대규모 서비스에서 확장성과 유지보수성이 뛰어남

## 쿼리스트링 사용법

- App Router 에서는 쿼리 스트링이나 URL 파라미터와 같은
  경로상에 포함되는 값들은 페이지 컴포넌트에게 모두 porps로 전달됨

  ```tsx
  export default function Page(props) {
    console.log(props); // promise 객체 형태들 확인 할 수 있음

    return (
      <>
        <h1>page Component</h1>
      </>
    );
  }
  ```

- 쿼리스트링은 searchParams 값이 promise 객체 형태로 넘어옴
- 따라서 컴포넌트를 async 형태로 바꿔줘야함
- 해당 컴포넌트는 **`서버컴포넌트`** 로 동작하기 때문에
  async 를 붙혀줄 수 있음
- 더 자세한 내용은 이후 데이터 패칭 챕터에서 다룸

  ```tsx
  export default async function Page({
    searchParams,
  }: {
    searchParams: Promise<{ q: string }>;
  }) {
    const { q } = await searchParams;

    return (
      <>
        <h1>Search 페이지 : {q}</h1>
      </>
    );
  }
  ```

## 동적 파라미터 사용법

- 쿼리스트링과 같이 컴포넌트에게 전달되는 props로부터 꺼내와 사용
- url : http://localhost:3000/book/100

  ```tsx
  export default async function Page({
    params,
  }: {
    params: Promise<{ id: string }>;
  }) {
    const { id } = await params; // 100
    return (
      <>
        <h1>book/{id} page 입니다.</h1>
      </>
    );
  }
  ```

## 캐치 올 세그먼트 사용

- 폴더의 이름을 [...id] 로 변경
- url 파라미터가 아예 존재하지 않는 값에는 대응되지 않음
- url : http://localhost:3000/book/1110/12

  ```tsx
  export default async function Page({
    params,
  }: {
    params: Promise<{ id: string }>;
  }) {
    const { id } = await params; // [1110,12]
    return (
      <>
        <h1>book/{id} page 입니다.</h1>
      </>
    );
  }
  ```

## 옵셔널 캐치 올 세그먼트

- url파라미터가 없는 페이지에도 대응 가능
- 해당 page.tsx 파일이 랜더링됨
- url : http://localhost:3000/book

  ### 랜더링된 화면

  ```text
     book/ page 입니다.
  ```

## 주의사항

- 쿼리스트링을 꺼내 쓰는 방식중
  Promise 객체로부터 꺼내 쓰지 않은 경우는 이전 방식임
- 실습 진행시 반드시 URL 파라미터나 Search Params, Query String값은
  Promise 객체로부터 꼭 꺼내써야 함
